$.fancybox.helpers.history={current_hash:!1,parse_hash:function(){var e,t,n,r,i,o=window.location.hash.substr(1);return o&&o.length&&(e=o.split("-"),t=e[0]+"",n=parseFloat(e[1]),r=$("a[rel="+t+"]"),r.length||(r=$("a[data-fancybox-group="+t+"]")),n=n>0?n-1:1,i=r.eq(n)),[o,t,n,i]},check_hash:function(){var e=this.parse_hash();return!e[0]&&this.current_hash?void $.fancybox.close():void(e[0]!==this.current_hash&&(e[1]&&$.fancybox.isActive&&($.fancybox.current.element.data("fancybox-group")===e[1]||$.fancybox.current.element.attr("rel")===e[1])?$.fancybox.jumpto(e[2]):e[3]&&e[3].length&&e[3].trigger("click")))},init:function(){var e=this.parse_hash();$(window).bind("hashchange",$.proxy(this.check_hash,this)),e[3]&&e[3].length&&e[3].attr("data-fancybox-start",1)},beforeShow:function(e,t){var n=$(t.element).data("fancybox-group")||$(t.element).attr("rel")||"gallery";window.location.hash=this.current_hash=n+"-"+(t.index+1)},beforeClose:function(){this.current_hash=!1},afterClose:function(){var e,t,n=$(window),r=window.location;"pushState"in history?history.pushState("",document.title,r.pathname+r.search):(e=n.scrollTop(),t=n.scrollLeft(),r.hash="",n.scrollTop(e),n.scrollLeft(t))}},jQuery.isReady?$.fancybox.helpers.history.init():$(document).ready(function(){$.fancybox.helpers.history.init()});